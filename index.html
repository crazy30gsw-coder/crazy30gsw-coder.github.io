<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ã¾ã¨ã‚é€Ÿå ±ï¼ˆèŠ¸èƒ½Ã—æ”¿æ²»ï¼‰</title>
  <meta name="description" content="èŠ¸èƒ½ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸­å¿ƒã«ã€æ”¿æ²»ã‚‚æ··ãœãŸã¾ã¨ã‚é€Ÿå ±ã€‚RSSã‹ã‚‰è‡ªå‹•æ›´æ–°ã€‚" />
  <meta name="theme-color" content="#ff6a00" />

  <style>
    :root{
      --bg:#f3f3f3;
      --ink:#111;
      --muted:#666;
      --line:#e6e6e6;
      --brand:#ff6a00;
      --brand2:#ffcc00;
      --link:#0b57d0;
      --card:#fff;
      --shadow: 0 10px 25px rgba(0,0,0,.06);
      --radius:12px;
      --max:1120px;
      --side:320px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      background:var(--bg);
      color:var(--ink);
    }
    a{color:var(--link); text-decoration:none}
    a:hover{text-decoration:underline}

    /* ===== Header ===== */
    header{
      background: linear-gradient(180deg, #ff7a1a, #ff6a00);
      border-bottom: 1px solid rgba(0,0,0,.08);
      position:sticky;
      top:0;
      z-index:50;
    }
    .hwrap{max-width:var(--max); margin:0 auto; padding:12px 14px;}
    .hbar{display:flex; align-items:center; gap:12px;}
    .logo{
      width:44px;height:44px;border-radius:12px;
      background: linear-gradient(135deg, var(--brand2), #fff);
      display:grid;place-items:center;
      font-weight:1000;
      color:#111;
      box-shadow: 0 10px 25px rgba(0,0,0,.10);
      flex:0 0 auto;
    }
    .sitename{
      display:flex; flex-direction:column; line-height:1.1;
      color:#fff;
      min-width:0;
    }
    .sitename b{font-size:20px; letter-spacing:.02em; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .sitename small{opacity:.92}
    .hmeta{
      margin-left:auto;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      color:#fff;
      font-size:12px;
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(6px);
    }
    .dot{width:8px;height:8px;border-radius:999px;background:#fff}
    .btn{
      border:1px solid rgba(255,255,255,.28);
      background: rgba(255,255,255,.18);
      color:#fff;
      font-weight:900;
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
    }
    .btn:active{transform:translateY(1px)}

    /* nav */
    .nav{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .tab{
      color:#fff;
      font-weight:900;
      font-size:13px;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.10);
      cursor:pointer;
      user-select:none;
    }
    .tab.on{
      background:#111;
      border-color:#111;
    }

    /* ===== Layout ===== */
    .wrap{max-width:var(--max); margin:0 auto; padding:14px;}
    .layout{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media(min-width:980px){
      .layout{
        grid-template-columns: 1fr var(--side);
        align-items:start;
      }
    }

    /* ===== Main box ===== */
    .box{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .boxtitle{
      padding:12px 14px;
      font-weight:1000;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, #ffffff, #fafafa);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .boxtitle small{color:var(--muted); font-weight:700}
    .tools{
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      background:#fff;
    }
    .search{
      flex:1 1 280px;
      display:flex; align-items:center; gap:10px;
      border:1px solid var(--line);
      border-radius:999px;
      padding:10px 12px;
      background:#fff;
    }
    .search input{
      width:100%;
      border:0; outline:0;
      font-size:14px;
    }
    .hint{color:var(--muted); font-size:12px}

    /* ===== Article list ===== */
    .list{padding:0}
    .item{
      display:flex;
      gap:12px;
      padding:12px 14px;
      border-top:1px solid var(--line);
      background:#fff;
    }
    .item:first-child{border-top:0}
    .thumb{
      width:140px; height:88px;
      border-radius:10px;
      overflow:hidden;
      background:#eee;
      flex:0 0 140px;
      position:relative;
      border:1px solid #efefef;
    }
    .thumb img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
    }
    .badge{
      position:absolute;
      left:8px; top:8px;
      background:rgba(17,17,17,.85);
      color:#fff;
      font-weight:1000;
      font-size:12px;
      padding:5px 8px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }

    .content{min-width:0; flex:1 1 auto; display:flex; flex-direction:column; gap:6px;}
    .title{
      font-weight:1000;
      font-size:16px;
      line-height:1.25;
      color:#0b3aa6;
      display:-webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      color:var(--muted);
      font-size:12px;
      margin-top:auto;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      padding:5px 10px;
      border-radius:999px;
      background:#fff7ef;
      border:1px solid #ffd7bb;
      color:#7a2f00;
      font-weight:1000;
    }
    .src{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:#111;
      font-weight:800;
    }
    .favicon{width:14px;height:14px;border-radius:4px; background:#e5e7eb}
    .desc{
      color:#333;
      font-size:13px;
      line-height:1.45;
      display:-webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }

    .linkAll{
      display:flex;
      color:inherit;
      text-decoration:none;
      width:100%;
    }
    .linkAll:hover{text-decoration:none}

    /* ===== Sidebar ===== */
    .sidepad{padding:12px 14px;}
    .sideSection + .sideSection{margin-top:12px;}
    .sideTitle{
      font-weight:1000;
      border-left:5px solid var(--brand);
      padding-left:10px;
      margin:0 0 10px;
    }
    .sideList{display:flex; flex-direction:column; gap:8px;}
    .sideItem{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px;
      border:1px solid var(--line);
      border-radius:12px;
      background:#fff;
    }
    .rank{
      width:28px;height:28px;border-radius:10px;
      display:grid;place-items:center;
      background:#111;
      color:#fff;
      font-weight:1000;
      flex:0 0 28px;
    }
    .sideItem b{
      font-size:13px; line-height:1.25;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
      color:#0b3aa6;
    }
    .foot{
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
      padding:12px 14px;
      border-top:1px solid var(--line);
      background:#fafafa;
    }
    .empty{
      padding:14px;
      color:var(--muted);
      font-size:14px;
    }
  </style>
</head>

<body>
<header>
  <div class="hwrap">
    <div class="hbar">
      <div class="logo">é€Ÿ</div>
      <div class="sitename">
        <b>ã¾ã¨ã‚é€Ÿå ±ï¼ˆèŠ¸èƒ½Ã—æ”¿æ²»ï¼‰</b>
        <small>RSSã‹ã‚‰è‡ªå‹•æ›´æ–°</small>
      </div>

      <div class="hmeta">
        <span class="pill"><span class="dot"></span><span id="statText">èª­ã¿è¾¼ã¿ä¸­â€¦</span></span>
        <span class="pill">æ›´æ–°: <span id="updatedAt">-</span></span>
        <button class="btn" id="reloadBtn" type="button">å†èª­ã¿è¾¼ã¿</button>
      </div>
    </div>

    <div class="nav" id="tabs">
      <div class="tab on" data-filter="all">å…¨éƒ¨</div>
      <div class="tab" data-filter="ent">èŠ¸èƒ½</div>
      <div class="tab" data-filter="sc">ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«</div>
      <div class="tab" data-filter="pol">æ”¿æ²»</div>
      <div class="tab" data-filter="other">ãã®ä»–</div>
    </div>
  </div>
</header>

<div class="wrap">
  <div class="layout">
    <!-- Main -->
    <section class="box">
      <div class="boxtitle">
        <span>æœ€æ–°è¨˜äº‹</span>
        <small>è¡¨ç¤ºä¸­: <b id="shown">0</b> / å…¨ <b id="total">0</b></small>
      </div>

      <div class="tools">
        <div class="search" role="search" aria-label="æ¤œç´¢">
          ğŸ” <input id="q" type="search" placeholder="æ¤œç´¢ï¼ˆä¾‹ï¼šçµå©šã€ç‚ä¸Šã€é€®æ•ã€ç·ç†ã€é¸æŒ™â€¦ï¼‰" />
        </div>
        <div class="hint" id="hint"></div>
      </div>

      <div class="list" id="list"></div>
      <div class="empty" id="empty" style="display:none;">è©²å½“ã™ã‚‹è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div>

      <div class="foot">
        â€» RSSç­‰ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±ã‚’æ•´å½¢ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚å†…å®¹ã¯å…ƒè¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚<br/>
        â€» ç”»åƒã¯å–ã‚Œãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ˆãã®å ´åˆã¯è‡ªå‹•ã‚µãƒ ãƒã‚’è¡¨ç¤ºï¼‰ã€‚
      </div>
    </section>

    <!-- Sidebar -->
    <aside class="box">
      <div class="boxtitle"><span>ã‚µã‚¤ãƒ‰ãƒãƒ¼</span><small>ãã‚Œã£ã½ã•å¼·åŒ–</small></div>
      <div class="sidepad">
        <div class="sideSection">
          <h3 class="sideTitle">äººæ°—è¨˜äº‹ï¼ˆä»®ï¼‰</h3>
          <div class="sideList" id="popular"></div>
        </div>

        <div class="sideSection">
          <h3 class="sideTitle">ã‚«ãƒ†ã‚´ãƒª</h3>
          <div class="sideList" id="cats"></div>
        </div>

        <div class="sideSection">
          <h3 class="sideTitle">æ›´æ–°æƒ…å ±</h3>
          <div class="sideList">
            <div class="sideItem"><div class="rank">i</div><div><b>è‡ªå‹•æ›´æ–°ï¼šGitHub Actions</b><div style="color:var(--muted);font-size:12px;margin-top:4px">posts.json ã‚’æ›´æ–° â†’ åæ˜ </div></div></div>
          </div>
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
  const POSTS_URL = "./posts.json";

  function escapeHtml(s){
    return String(s ?? "").replace(/[&<>"']/g, c => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[c]));
  }
  function hostOf(url){
    try{ return new URL(url).hostname.replace(/^www\./,""); } catch { return ""; }
  }
  function faviconUrl(url){
    const h = hostOf(url);
    return h ? `https://www.google.com/s2/favicons?domain=${h}&sz=64` : "";
  }
  function fmtDate(iso){
    try{
      const d = new Date(iso);
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,"0");
      const day = String(d.getDate()).padStart(2,"0");
      const hh = String(d.getHours()).padStart(2,"0");
      const mm = String(d.getMinutes()).padStart(2,"0");
      return `${y}/${m}/${day} ${hh}:${mm}`;
    } catch { return iso || "-"; }
  }
  function timeAgo(iso){
    try{
      const t = new Date(iso).getTime();
      const diff = Date.now() - t;
      const min = Math.floor(diff/60000);
      if(min < 1) return "ãŸã£ãŸä»Š";
      if(min < 60) return `${min}åˆ†å‰`;
      const h = Math.floor(min/60);
      if(h < 24) return `${h}æ™‚é–“å‰`;
      const d = Math.floor(h/24);
      return `${d}æ—¥å‰`;
    } catch { return ""; }
  }

  // ç”»åƒãŒå–ã‚Œãªã„æ™‚ã®ã€Œãã‚Œã£ã½ã„ã€è‡ªå‹•ã‚µãƒ ãƒï¼ˆé»’Ã—ã‚ªãƒ¬ãƒ³ã‚¸ï¼‰
  function placeholderSvg(word="NO IMAGE"){
    const safe = String(word).slice(0,18);
    const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="560" height="320">
      <defs>
        <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="#0b1220"/>
          <stop offset="1" stop-color="#111827"/>
        </linearGradient>
      </defs>
      <rect width="100%" height="100%" fill="url(#g)"/>
      <circle cx="470" cy="70" r="90" fill="rgba(255,106,0,.25)"/>
      <circle cx="420" cy="110" r="60" fill="rgba(255,204,0,.18)"/>
      <text x="40" y="210" font-size="48" fill="rgba(255,255,255,.92)" font-family="system-ui" font-weight="900">${escapeHtml(safe)}</text>
      <text x="40" y="250" font-size="20" fill="rgba(255,255,255,.65)" font-family="system-ui">ã¾ã¨ã‚é€Ÿå ±</text>
    </svg>`;
    return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg);
  }

  // jinã£ã½ã„åˆ†é¡ï¼ˆèŠ¸èƒ½/ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«/æ”¿æ²»ï¼‰
  function pickCategory(p){
    const t = ((p.title||"") + " " + (p.description||"") + " " + (p.source||"") + " " + (p.url||"")).toLowerCase();

    const scandal = ["ä¸å€«","æµ®æ°—","ç‚ä¸Š","é€®æ•","è§£é›‡","é™æ¿","è¬ç½ª","æå®³","æš´éœ²","æµå‡º","ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«","é•æ³•","è³­åš","è–¬","æš´åŠ›","ãƒ‘ãƒ¯ãƒãƒ©","ã‚»ã‚¯ãƒãƒ©","èª¹è¬—ä¸­å‚·"];
    const politics = ["æ”¿æ²»","ç·ç†","é¦–ç›¸","å®˜æˆ¿","å¤§è‡£","ä¸å…š","é‡å…š","å›½ä¼š","é¸æŒ™","æŠ•ç¥¨","æ”¯æŒç‡","ç¨","å¢—ç¨","æ¸›ç¨","å¤–äº¤","å†…é–£","æ³•æ¡ˆ","éƒ½çŸ¥äº‹","çŸ¥äº‹","å¸‚é•·"];

    if (scandal.some(w => t.includes(w))) return "sc";
    if (politics.some(w => t.includes(w))) return "pol";

    // èŠ¸èƒ½ã£ã½ã„ãƒ¯ãƒ¼ãƒ‰ï¼ˆåºƒã‚ï¼‰
    const ent = ["èŠ¸èƒ½","ä¿³å„ª","å¥³å„ª","ã‚¢ã‚¤ãƒ‰ãƒ«","çµå©š","é›¢å©š","ç†±æ„›","ãƒ‰ãƒ©ãƒ","æ˜ ç”»","ãƒ†ãƒ¬ãƒ“","cm","ç•ªçµ„","æ­Œæ‰‹","ãƒ©ã‚¤ãƒ–","ãƒ¦ãƒ¼ãƒãƒ¥ãƒ¼ãƒãƒ¼","youtuber","tiktok","ã‚¤ãƒ³ã‚¹ã‚¿","sns"];
    if (ent.some(w => t.includes(w))) return "ent";

    return "other";
  }

  function label(cat){
    if(cat==="ent") return "èŠ¸èƒ½";
    if(cat==="sc") return "ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«";
    if(cat==="pol") return "æ”¿æ²»";
    return "ãã®ä»–";
  }

  let ALL = [];
  let current = "all";

  function render(){
    const q = (document.getElementById("q").value || "").trim().toLowerCase();
    let items = ALL.slice();

    if(current !== "all"){
      items = items.filter(x => x._cat === current);
    }
    if(q){
      items = items.filter(x => ((x.title||"") + " " + (x.description||"") + " " + (x.source||"")).toLowerCase().includes(q));
    }

    document.getElementById("shown").textContent = String(items.length);
    document.getElementById("total").textContent = String(ALL.length);

    const list = document.getElementById("list");
    list.innerHTML = "";

    const empty = document.getElementById("empty");
    if(!items.length){
      empty.style.display = "block";
      return;
    }
    empty.style.display = "none";

    const frag = document.createDocumentFragment();

    for(const p of items){
      const row = document.createElement("div");
      row.className = "item";

      const a = document.createElement("a");
      a.className = "linkAll";
      a.href = p.url;
      a.target = "_blank";
      a.rel = "noopener noreferrer";

      const th = document.createElement("div");
      th.className = "thumb";
      const img = document.createElement("img");
      img.loading = "lazy";
      img.alt = p.title || "";
      img.src = p.image || placeholderSvg(label(p._cat));
      img.onerror = () => { img.src = placeholderSvg(label(p._cat)); };

      const badge = document.createElement("div");
      badge.className = "badge";
      badge.textContent = timeAgo(p.date) || "NEW";

      th.appendChild(img);
      th.appendChild(badge);

      const ct = document.createElement("div");
      ct.className = "content";

      const ttl = document.createElement("div");
      ttl.className = "title";
      ttl.textContent = p.title || "(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)";

      const desc = document.createElement("div");
      desc.className = "desc";
      desc.textContent = p.description || "";

      const meta = document.createElement("div");
      meta.className = "meta";

      const tag = document.createElement("span");
      tag.className = "tag";
      tag.textContent = label(p._cat);

      const src = document.createElement("span");
      src.className = "src";
      const fav = faviconUrl(p.url);
      src.innerHTML = `${fav ? `<img class="favicon" src="${fav}" alt="" onerror="this.style.display='none'">` : ""}<span>${escapeHtml(p.source || hostOf(p.url) || "source")}</span>`;

      const time = document.createElement("span");
      time.textContent = fmtDate(p.date);

      meta.appendChild(tag);
      meta.appendChild(src);
      meta.appendChild(time);

      ct.appendChild(ttl);
      if(p.description) ct.appendChild(desc);
      ct.appendChild(meta);

      a.appendChild(th);
      a.appendChild(ct);

      row.appendChild(a);
      frag.appendChild(row);
    }
    list.appendChild(frag);

    // äººæ°—è¨˜äº‹ï¼ˆä»®ï¼‰ï¼šå…ˆé ­ã‹ã‚‰5æœ¬ã‚’è¡¨ç¤º
    const pop = document.getElementById("popular");
    pop.innerHTML = "";
    ALL.slice(0,5).forEach((p,i)=>{
      const box = document.createElement("a");
      box.className = "sideItem";
      box.href = p.url;
      box.target = "_blank";
      box.rel = "noopener noreferrer";
      box.innerHTML = `<div class="rank">${i+1}</div><div><b>${escapeHtml(p.title || "")}</b><div style="color:var(--muted);font-size:12px;margin-top:4px">${escapeHtml(p.source || hostOf(p.url) || "")}</div></div>`;
      pop.appendChild(box);
    });

    // ã‚«ãƒ†ã‚´ãƒªï¼ˆä»¶æ•°ï¼‰
    const cats = { ent:0, sc:0, pol:0, other:0 };
    ALL.forEach(p=>cats[p._cat] = (cats[p._cat]||0)+1);
    const catsEl = document.getElementById("cats");
    catsEl.innerHTML = "";
    Object.entries(cats).forEach(([k,v])=>{
      const box = document.createElement("div");
      box.className = "sideItem";
      box.innerHTML = `<div class="rank">${label(k).slice(0,1)}</div><div><b>${label(k)}</b><div style="color:var(--muted);font-size:12px;margin-top:4px">${v}ä»¶</div></div>`;
      catsEl.appendChild(box);
    });
  }

  async function load(){
    document.getElementById("hint").textContent = "";
    document.getElementById("statText").textContent = "èª­ã¿è¾¼ã¿ä¸­â€¦";
    try{
      const res = await fetch(POSTS_URL + "?v=" + Date.now(), { cache: "no-store" });
      if(!res.ok) throw new Error("HTTP " + res.status);
      const data = await res.json();

      let posts = [];
      let updatedAt = null;
      if(Array.isArray(data)){
        posts = data;
      } else {
        posts = data.posts || [];
        updatedAt = data.updatedAt || null;
      }

      ALL = posts.map(p=>{
        const url = p.url || p.link || "";
        const obj = {
          title: p.title || "",
          url,
          source: p.source || hostOf(url) || "",
          date: p.date || p.published || p.pubDate || new Date().toISOString(),
          image: p.image || p.ogImage || p.thumbnail || "",
          description: p.description || p.summary || ""
        };
        obj._cat = pickCategory(obj);
        return obj;
      }).sort((a,b)=> new Date(b.date) - new Date(a.date));

      document.getElementById("updatedAt").textContent = updatedAt ? fmtDate(updatedAt) : (ALL[0]?.date ? fmtDate(ALL[0].date) : "-");
      document.getElementById("statText").textContent = `å…¨${ALL.length}ä»¶`;
      render();
    } catch(err){
      console.error(err);
      document.getElementById("statText").textContent = "èª­ã¿è¾¼ã¿å¤±æ•—";
      document.getElementById("hint").textContent = "posts.json ãŒè¦‹ã¤ã‹ã‚‰ãªã„/å£Šã‚Œã¦ã‚‹å¯èƒ½æ€§";
      document.getElementById("empty").style.display = "block";
      document.getElementById("empty").textContent = "èª­ã¿è¾¼ã¿å¤±æ•—: posts.json ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‹å£Šã‚Œã¦ã¾ã™";
    }
  }

  // Tabs
  document.getElementById("tabs").addEventListener("click", (e)=>{
    const t = e.target.closest(".tab");
    if(!t) return;
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("on"));
    t.classList.add("on");
    current = t.dataset.filter || "all";
    render();
  });

  document.getElementById("reloadBtn").addEventListener("click", load);
  document.getElementById("q").addEventListener("input", render);

  load();
</script>
</body>
</html>